import pymongo
import json

# client = pymongo.MongoClient(host="172.22.69.35", port=20000)
# client = pymongo.MongoClient(host="172.22.69.41", port=20000)
client = pymongo.MongoClient(host="localhost", port=27017)
# ip_list = ['192.168.1.73', '192.168.1.81', '192.168.1.102']
# client = pymongo.MongoClient(ip_list, port=27017)

datasc = client["spider_url_fixed"]
collection_CCBPage = datasc['CCBPage']
collection_CCBArea = datasc['CCBArea_all']
collection_CCBArea2082 = datasc['CCBArea_2082']
collection_CCBArea_a= datasc['CCBArea_a']
collection_CCBArea_b = datasc['CCBArea_b']
collection_CCBArea_c = datasc['CCBArea_c']

res = list(collection_CCBArea.find())
res2082 = list(collection_CCBArea2082.find())

t2082 = ['140107', '120117', '120118', '140201', '140401', '140430', '140301', '140525', '140701', '140801', '141027', '141030', '141031', '141032', '141034', '130132', '130301', '130203', '130223', '130421', '130428', '130429', '130501', '130521', '130601', '130701', '130801', '130804', '131001', '210115', '210401', '210421', '210801', '210901', '210905', '211011', '211224', '211321', '211404', '220113', '220201', '220301', '220302', '220303', '220501', '220401', '220601', '220701', '220801', '230301', '230303', '230304', '230305', '230307', '230501', '230503', '230505', '230401', '230406', '230407', '230606', '230706', '230707', '230708', '230709', '230711', '230714', '230715', '230716', '230722', '230822', '230828', '230201', '230205', '230208', '230223', '230901', '232702', '232703', '232704', '232723', '231121', '231123', '231124', '231202', '231223', '231225', '231226', '320205', '320206', '320214', '320312', '320401', '320505', '320602', '320611', '320812', '320901', '321102', '321111', '321112', '321302', '321311', '330201', '330204', '330185', '330601', '330701', '331001', '330901', '340201', '340208', '340301', '340311', '340401', '340402', '340701', '340711', '340801', '340811', '341001', '341201', '341301', '341501', '341601', '341801', '350201', '350301', '350501', '350527', '350581', '350582', '350583', '350401', '350402', '350403', '350421', '350423', '350424', '350425', '350426', '350427', '350428', '350429', '350430', '350481', '350701', '350702', '350703', '350721', '350722', '350723', '350724', '350725', '350781', '350782', '350783', '350801', '350802', '350803', '350821', '350823', '350824', '350825', '350881', '350901', '350902', '350921', '350922', '350923', '350924', '350925', '350926', '350981', '350982', '350601', '350603', '350622', '350623', '350626', '350627', '350628', '350629', '350681', '360102', '360104', '360105', '360111', '360112', '360121', '360123', '360124', '360201', '360202', '360203', '360281', '360301', '360302', '360313', '360321', '360322', '360323', '360501', '360502', '360521', '360601', '360602', '360622', '360681', '360401', '360402', '360403', '360423', '360424', '360425', '360426', '360428', '360429', '360430', '360482', '360483', '360701', '360702', '360703', '360721', '360722', '360723', '360724', '360725', '360726', '360727', '360728', '360729', '360730', '360731', '360732', '360733', '360734', '360735', '360901', '360902', '360921', '360922', '360923', '360924', '360925', '360926', '360981', '360982', '360983', '360801', '360802', '360803', '360821', '360822', '360823', '360824', '360825', '360826', '360828', '360829', '360830', '360881', '361002', '361021', '361022', '361023', '361024', '361025', '361026', '361028', '361029', '361030', '361102', '361103', '361121', '361123', '361124', '361125', '361126', '361127', '361128', '361129', '361130', '361181', '370102', '370103', '370104', '370105', '370112', '370113', '370124', '370125', '370126', '370181', '370301', '370302', '370303', '370304', '370305', '370306', '370321', '370323', '370402', '370403', '370404', '370405', '370406', '370481', '370201', '370202', '370203', '370211', '370212', '370213', '370214', '370281', '370282', '370283', '370285', '370502', '370503', '370505', '370522', '370523', '370601', '370602', '370611', '370612', '370613', '370634', '370682', '370683', '370684', '370685', '370686', '370687', '370701', '370702', '370703', '370704', '370705', '370724', '370725', '370781', '370782', '370783', '370784', '370785', '370786', '370901', '370902', '370911', '370921', '370923', '370982', '371001', '371002', '371003', '371082', '371083', '370801', '370811', '370826', '370827', '370829', '370830', '370831', '370832', '370881', '370883', '371102', '371121', '371122', '371201', '371202', '371203', '371402', '371403', '371422', '371423', '371424', '371425', '371426', '371427', '371428', '371481', '371482', '371501', '371502', '371521', '371522', '371523', '371524', '371525', '371526', '371581', '371301', '371302', '371311', '371312', '371321', '371322', '371323', '371324', '371325', '371326', '371328', '371329', '410103', '410104', '410105', '410106', '410122', '410181', '410183', '410184', '410201', '410203', '410204', '410205', '410211', '410212', '410221', '410222', '410223', '410225', '410301', '410302', '410304', '410305', '410306', '410311', '410322', '410323', '410324', '410325', '410326', '410327', '410328', '410329', '410381', '371701', '371702', '371703', '371721', '371722', '371723', '371724', '371725', '371726', '371728', '371601', '371603', '371621', '371622', '371625', '371626', '410401', '410402', '410403', '410404', '410411', '410421', '410422', '410423', '410425', '410481', '410482', '410501', '410502', '410503', '410505', '410522', '410523', '410526', '410527', '410581', '410701', '410702', '410703', '410704', '410711', '410721', '410724', '410725', '410726', '410727', '410728', '410781', '410782', '410601', '410602', '410603', '410611', '410621', '410622', '410801', '410802', '410803', '410804', '410811', '410821', '410822', '410823', '410825', '410882', '410883', '410902', '410922', '410923', '410926', '411001', '411002', '411023', '411024', '411025', '411081', '411082', '411201', '411202', '411203', '411221', '411224', '411281', '411282', '411102', '411103', '411104', '411121', '411122', '411601', '411602', '411621', '411622', '411624', '411625', '411626', '411627', '411628', '411681', '411501', '411502', '411503', '411521', '411522', '411523', '411524', '411525', '411526', '411528', '411301', '411302', '411303', '411323', '411324', '411325', '411326', '411327', '411328', '411329', '411330', '411381', '411401', '411402', '411403', '411421', '411422', '411423', '411424', '411425', '411426', '411481', '411701', '411702', '411721', '411722', '411723', '411724', '411725', '411726', '411727', '411728', '411729', '419001', '150102', '150103', '150104', '150105', '150121', '150122', '150123', '150124', '150125', '150301', '150302', '150304', '150201', '150202', '150203', '150204', '150205', '150206', '150207', '150221', '150222', '150223', '150501', '150502', '150521', '150522', '150523', '150524', '150525', '150526', '150581', '150401', '150402', '150403', '150404', '150421', '150422', '150424', '150425', '150426', '150428', '150429', '150430', '150601', '150602', '150603', '150621', '150623', '150624', '150625', '150626', '150627', '150701', '150702', '150703', '150721', '150722', '150723', '150724', '150725', '150726', '150727', '150781', '150782', '150783', '150784', '150785', '150801', '150802', '150821', '150822', '150823', '150824', '150826', '150901', '150902', '150921', '150923', '150924', '150925', '150926', '150927', '150928', '150929', '150981', '152501', '152502', '152522', '152523', '152524', '152525', '152526', '152527', '152528', '152529', '152530', '152531', '152201', '152202', '152221', '152222', '152223', '152224', '420102', '420103', '420104', '420105', '420106', '420107', '420111', '420112', '420113', '420114', '420115', '420116', '420117', '152921', '152922', '152923', '420301', '420302', '420303', '420304', '420322', '420323', '420324', '420325', '420381', '420201', '420202', '420203', '420204', '420205', '420501', '420502', '420503', '420504', '420506', '420525', '420526', '420527', '420528', '420529', '420581', '420582', '420583', '420601', '420602', '420606', '420607', '420624', '420625', '420626', '420682', '420683', '420684', '420701', '420702', '420703', '420704', '421102', '421121', '421122', '421123', '421124', '421125', '421126', '421127', '421182', '421201', '421202', '421221', '421222', '421223', '421224', '421281', '422801', '422802', '422822', '422823', '422825', '422826', '422827', '422828', '421301', '421303', '421321', '421381', '450102', '450103', '450105', '450107', '450108', '450109', '450110', '450123', '450124', '450125', '450126', '450127', '429004', '429005', '429006', '429021', '450201', '450202', '450203', '450204', '450205', '450206', '450222', '450223', '450224', '450225', '450226', '420801', '420802', '420804', '420821', '420822', '450301', '450302', '450303', '450304', '450305', '450311', '450312', '450321', '450323', '450324', '450325', '450326', '450327', '450328', '450329', '450330', '450331', '450332', '450501', '450502', '450503', '450512', '450521', '450601', '450602', '450603', '450621', '450681', '450701', '450702', '450703', '450721', '450722', '450801', '450802', '450803', '450804', '450821', '450881', '451201', '451202', '451221', '451222', '451223', '451224', '451225', '451226', '451227', '451228', '451229', '451281', '451401', '451402', '451421', '451422', '451423', '451424', '451425', '451481', '451301', '451302', '451321', '451322', '451324', '440103', '440104', '440106', '440111', '440112', '440113', '440114', '440115', '440117', '440118', '440201', '440203', '440204', '440205', '440222', '440224', '440229', '440232', '440233', '440281', '440282', '440301', '440303', '440304', '440305', '440306', '440307', '440308', '440401', '440402', '440403', '440404', '440601', '440604', '440605', '440606', '440607', '440608', '440901', '440902', '440904', '440981', '440982', '440983', '441202', '441203', '441204', '441223', '441224', '441225', '441226', '441284', '441301', '441302', '441303', '441322', '441323', '441324', '441501', '441502', '441521', '441523', '441581', '441601', '441602', '441621', '441622', '441623', '441624', '441625', '441701', '441702', '441704', '441721', '441781', '441801', '441802', '441821', '441823', '441825', '441826', '441881', '441882', '445102', '445103', '445122', '445201', '445202', '445203', '445222', '445224', '445281', '445301', '445302', '445303', '445321', '445381', '460106', '460107', '460108', '460201', '460202', '460203', '460204', '460205', '500101', '500103', '500104', '500105', '500106', '500107', '500108', '500109', '500111', '500112', '500113', '500114', '500115', '500116', '500117', '500118', '500119', '500120', '500151', '500152', '500153', '500154', '500228', '500229', '500230', '500231', '500232', '500233', '500235', '500237', '500238', '500240', '500241', '500242', '500243', '510104', '510105', '510107', '510108', '510112', '510113', '510114', '510115', '510116', '510121', '510124', '510129', '510131', '510132', '510181', '510182', '510183', '510184', '510401', '510402', '510403', '510411', '510421', '510422', '510501', '510502', '510504', '510521', '510522', '510524', '510525', '510701', '510703', '510704', '510705', '510722', '510723', '510725', '510726', '510727', '510781', '510801', '510802', '510811', '510812', '510821', '510822', '510823', '510824', '511001', '511002', '511011', '511024', '511025', '511028', '511102', '511111', '511112', '511113', '511123', '511124', '511126', '511129', '511132', '511133', '511181', '511301', '511302', '511303', '511304', '511321', '511322', '511323', '511324', '511325', '511381', '511401', '511402', '511403', '511421', '511423', '511424', '511425', '511501', '511502', '511503', '511521', '511523', '511524', '511525', '511526', '511527', '511528', '511529', '511601', '511602', '511603', '511621', '511622', '511623', '511681', '511702', '511703', '511723', '511724', '511725', '511781', '420902', '420921', '420922', '420923', '420981', '420982', '420984', '513301', '513322', '513323', '513324', '513325', '513326', '513327', '513328', '513329', '513330', '513331', '513332', '513333', '513334', '513335', '513336', '513337', '513338', '513401', '513423', '513424', '513425', '513426', '513427', '513428', '513429', '513430', '513431', '513432', '513433', '513434', '513435', '513436', '513437', '520102', '520103', '520111', '520112', '520113', '520115', '520121', '520122', '520123', '520181', '513201', '513221', '513222', '513223', '513224', '513225', '513226', '513227', '513228', '513230', '513231', '513232', '513233', '520301', '520302', '520303', '520304', '520323', '520324', '520325', '520326', '520327', '520329', '520330', '520381', '520382', '520201', '520203', '520221', '520222', '520401', '520402', '520403', '520422', '520423', '520425', '520501', '520502', '520521', '520522', '520523', '520524', '520525', '520526', '520527', '520601', '520602', '520603', '520621', '520622', '520623', '520624', '520626', '520627', '520628', '450403', '450405', '450421', '450422', '450423', '450481', '450902', '450903', '450921', '450922', '450923', '450924', '450981', '522601', '522622', '522623', '522624', '522625', '522626', '522627', '522628', '522629', '522630', '522631', '522632', '522633', '522634', '522635', '522636', '451103', '451121', '451122', '451123', '430102', '430103', '430104', '430105', '430111', '430112', '430121', '430124', '430181', '522701', '522702', '522722', '522723', '522725', '522726', '522727', '522728', '522729', '522730', '522731', '522732', '451001', '451002', '451021', '451022', '451023', '451024', '451026', '451027', '451028', '451029', '451030', '451031', '451081', '430301', '430302', '430304', '430321', '430381', '430382', '430401', '430405', '430406', '430407', '430412', '430421', '430422', '430423', '430424', '430426', '430481', '430482', '430501', '430502', '430503', '430511', '430521', '430522', '430523', '430524', '430525', '430527', '430528', '430529', '430581', '430601', '430602', '430603', '430611', '430621', '430623', '430624', '430626', '430681', '430682', '440501', '440507', '440511', '440512', '440514', '440515', '440523', '430701', '430703', '430721', '430723', '430724', '430725', '430726', '430781', '430901', '430902', '430903', '430921', '430923', '430801', '430802', '430811', '430821', '430822', '440801', '440802', '440803', '440804', '440811', '440823', '440825', '440881', '440882', '440883', '431001', '431002', '431003', '431021', '431022', '431023', '431024', '431025', '431026', '431027', '431028', '431102', '431103', '431121', '431123', '431124', '431125', '431126', '431127', '431128', '431129', '431201', '431202', '431221', '431222', '431223', '431224', '431225', '431226', '431227', '431228', '431229', '431230', '431281', '441401', '441402', '441403', '441422', '441423', '441424', '441426', '441427', '441481', '431301', '431302', '431321', '431322', '431381', '431382', '440701', '440703', '440704', '440705', '440781', '440783', '440784', '440785', '433122', '433123', '433124', '433125', '433126', '433127', '433130', '530102', '530103', '530111', '530112', '530113', '530114', '530122', '530124', '530125', '530126', '530127', '530128', '530181', '530401', '530402', '530403', '530422', '530423', '530424', '530425', '530426', '530427', '530428', '530301', '530302', '530321', '530322', '530323', '530324', '530325', '530326', '530381', '530501', '530502', '530521', '530523', '530524', '530581', '530601', '530602', '530621', '530622', '530623', '530624', '530625', '530626', '530627', '530628', '530629', '530630', '469001', '469002', '469005', '469007', '469021', '469022', '469023', '469024', '469025', '469026', '469027', '469028', '469029', '469030', '530701', '530702', '530721', '530722', '530723', '530724', '530801', '530802', '530821', '530822', '530823', '530824', '530825', '530826', '530827', '530828', '530829', '530901', '530902', '530921', '530922', '530923', '530924', '530925', '530926', '530927', '532501', '532502', '532503', '532504', '532523', '532524', '532525', '532527', '532528', '532529', '532530', '532531', '532532', '532301', '532322', '532323', '532325', '532327', '532328', '532329', '532331', '532601', '532622', '532623', '532624', '532625', '532626', '532627', '532628', '510301', '510302', '510303', '510304', '510311', '510321', '510322', '532901', '532922', '532923', '532924', '532925', '532926', '532927', '532928', '532929', '532930', '532931', '532932', '510601', '510603', '510623', '510626', '510681', '510682', '510901', '510903', '510904', '510921', '510922', '510923', '532801', '532822', '532823', '533301', '533323', '533324', '533325', '533401', '533422', '533423', '540102', '540103', '540121', '540122', '540123', '540124', '540126', '540127', '533102', '533103', '533122', '533123', '533124', '540202', '540221', '540222', '540223', '540224', '540225', '540226', '540227', '540228', '540229', '540230', '540231', '540232', '540233', '540234', '540235', '540236', '540237', '540402', '540421', '540422', '540423', '540424', '540425', '540426', '540302', '540321', '540322', '540323', '540324', '540325', '540326', '540327', '540328', '540329', '540330', '511801', '511802', '511803', '511822', '511824', '511825', '511826', '511827', '512001', '512002', '512021', '512022', '540501', '540502', '540521', '540522', '540523', '540524', '540525', '540526', '540527', '540528', '540529', '540530', '540531', '542521', '542522', '542523', '542524', '542525', '542526', '542527', '610102', '610103', '610104', '610111', '610112', '610113', '610114', '610115', '610116', '610117', '610122', '610124', '610125', '610201', '610202', '610203', '610204', '610222', '610301', '610302', '610303', '610304', '610322', '610323', '610324', '610326', '610327', '610328', '610329', '610330', '610331', '610501', '610502', '610503', '610522', '610523', '610524', '610525', '610526', '610527', '610528', '610581', '610582', '610601', '610602', '610603', '610621', '610622', '610623', '610625', '610626', '610627', '610628', '610629', '610630', '610631', '610632', '610701', '610702', '610721', '610722', '610724', '610725', '610726', '610727', '610728', '610729', '610730', '610801', '610802', '610803', '610822', '610825', '610826', '610827', '610828', '610829', '610830', '610831', '610401', '610402', '610403', '610404', '610422', '610423', '610424', '610425', '610426', '610427', '610428', '610429', '610430', '610431', '610901', '610902', '610921', '610922', '610923', '610924', '610925', '610926', '610927', '610928', '610929', '522301', '522322', '522323', '522324', '522325', '522326', '522327', '522328', '620102', '620103', '620104', '620105', '620111', '620121', '620122', '620123', '620201', '620301', '620302', '620321', '620401', '620402', '620403', '620421', '620422', '620423', '611001', '611002', '611021', '611022', '611023', '611024', '611025', '611026', '620501', '620502', '620503', '620522', '620523', '620524', '620525', '620701', '620702', '620721', '620722', '620723', '620724', '620725', '620601', '620602', '620621', '620622', '620623', '620801', '620802', '620821', '620822', '620823', '620824', '620825', '620826', '620901', '620902', '620922', '620923', '620924', '620981', '620982', '621001', '621002', '621021', '621022', '621023', '621024', '621025', '621026', '621027', '621102', '621121', '621122', '621124', '621125', '621126', '621201', '621221', '621222', '621223', '621224', '621226', '621227', '621228', '622901', '622921', '622922', '622923', '622924', '622925', '622926', '622927', '623001', '623021', '623022', '623023', '623024', '623025', '623026', '623027', '640104', '640105', '640106', '640121', '640122', '640181', '421001', '421002', '421003', '421022', '421023', '421024', '421081', '421083', '421087', '640201', '640202', '640205', '640221', '640401', '640402', '640422', '640423', '640424', '640425', '640501', '640502', '640521', '640522', '650102', '650103', '650104', '650105', '650106', '650107', '650109', '650121', '650201', '650202', '650203', '650204', '650205', '650402', '650421', '650422', '650502', '650521', '650522', '652301', '652302', '652323', '652324', '652325', '652327', '652328', '652701', '652702', '652722', '652723', '652801', '652822', '652823', '652824', '652825', '652826', '652827', '652828', '652829', '653001', '653022', '653023', '653024', '653121', '653122', '653123', '653124', '653125', '653126', '653127', '653128', '653129', '653130', '653131', '653201', '653221', '653222', '653223', '653224', '653225', '653226', '653227', '640301', '640302', '640303', '640323', '640324', '640381', '511901', '511902', '511903', '511921', '511922', '511923', '654201', '654202', '654221', '654223', '654224', '654225', '654226', '654321', '654322', '654323', '654324', '654325', '654326', '659001', '659002', '659003', '659004', '659006', '652901', '652922', '652923', '652924', '652925', '652926', '652927', '652928', '652929', '630202', '630203', '630222', '630223', '630224', '630225', '632221', '632222', '632223', '632224', '632321', '632322', '632323', '632324', '632522', '632523', '632524', '632525', '632621', '632622', '632623', '632624', '632625', '632626', '632701', '632722', '632723', '632724', '632725', '632726', '632801', '632802', '632822', '632823', '430201', '430202', '430203', '430211', '430221', '430224', '430225', '430281', '630102', '630103', '630104', '630105', '630121', '630122', '630123', '542421', '542422', '542423', '542424', '542425', '542426', '542427', '542428', '542429', '542430', '542431', '654002', '654003', '654004', '654021', '654022', '654023', '654024', '654025', '654026', '654027', '654028']
for m in res:
    if m['AREA_CODE_'] in t2082:
        pass
    else:
        del m['_id']
        collection_CCBArea_c.insert(m)

# area_codes = []
# res2 = list(collection_CCBORGANIZE.find())
# for m in res2:
#     area_codes.append(m['PARAM_'][11]['value'])
# print(area_codes)
# print(len(area_codes))

# for i in res:
#     if i['PARAM_'][0]['value'] == '[]':
#         collection_CCBPage.delete_one({'AREA_CODE_': i['AREA_CODE_']})
#         print(collection_CCBPage.count())
        # collection_CCBArea.update({'AREA_CODE_': i['AREA_CODE_']},{'$set': {'d': '1'}})

# num = 2082
# while num:
#     j = res.next()
#     del j['_id']
#     if num > 1041:
#         collection_CCBArea_a.insert(j)
#         num -= 1
#     else:
#         collection_CCBArea_b.insert(j)
#         num -= 1



